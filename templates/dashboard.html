{% extends 'sidebar.html' %}
{% block content %}
{% load static %}
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="{%static 'icofont/icofont.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{%static 'css/bootstrap.min.css' %}">
    

    <style>
   
       #chatbot-container {
            display: none; /* Ensures chatbot starts hidden */
            position: fixed;
            bottom: 50px;
            right: 20px;
            width: 370px;
            height: 500px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
           
        }
       
        #chat-container {
            flex-grow: 1;
            padding: 10px;
            overflow-y: auto;
            max-height: 300px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #chat-form {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background-color: #f7f7f7;
            border-top: 1px solid #ccc;
        }

        #user-input {
            width: 80%;
            padding: 5px 10px;
            border: 1px solid #ccc;
        }

        #chat-form button {
            width: 16%;
            background-color: #007bff;
            color: white;
            border: none;
            padding: 5px;
            cursor: pointer;
        }

        .message {
            padding: 10px;
            color: #ffffff;
            max-width: 80%;
            word-wrap: break-word;
        }

        .user-message {
            align-self: flex-end;
            background-color: #007bff;
        }

        .bot-message {
            align-self: flex-start;
            background-color: #333333;
        }
    </style>

   
   
</head>
<body>
    <div class="text-end m-3">
        Welcome,<strong> {{user.name}}</strong>
        {% if user.profile_picture %}
        <a href="{% url 'userprofile_s' %}" required>
          <img
            src="{{user.profile_picture.url}}"
            style="height: 70px; width: 70px; border-radius: 50%"
            alt="profile_picture"
          />
        </a>
        {% endif %}
      <h1 style="text-align:left;font-family:charlesworth;color:#12171b;margin-top:10px;margin-left:5px;font-weight:bold;margin-left:-20px;">Welcome to AgroStat a Predictive And Analysis Dashboard
      </h1>
    </div>
    <hr>
    <div class="row">
         <div class="col-md" style="margin-left:-40px;margin-top:15px;background-color:#f5f5f5;border-radius:10px;margin-bottom: 30px;">
            <div class="row"> 
                <div class="col-7" style="padding:10px;background-color:#f5f5f5;border-radius:10px;">
                    <h2 style="font-family:charlesworth;font-weight:bold;" class="text-center">Want to Do Prediction</h2>
                    <p style="font-family:charlesworth;font-size:17px;text-align:justify;margin-bottom:20px;">"Experience the future of brain health at your fingertips with our groundbreaking MRI scan analysis. Simply upload your scan, and with a single click, unlock invaluable insights into potential brain diseases. Effortlessly bridge the gap between diagnosis and treatment, revolutionizing healthcare with every upload."</p>
                   
<div class="mt-5 text-center">
                    <a href="/crops_production_prediction" style="background-color:#30363d;color:white;padding:13px;margin-right:15px;text-decoration:none;">Crop Production</a>
                    <a href="/fertilizer_detection" style="background-color:#30363d;color:white;padding:13px;text-decoration:none;margin-right: 12px;">Fertilizer</a>
                    <a href="/predict_population" style="background-color:#30363d;color:white;padding:13px;text-decoration:none;">Agriculturalist Trend</a>
                  </div>   </div>
                <div class="col-5" style="padding:10px;background-color:#f5f5f5;border-radius:10px;">
                  
                  <img src="static\images\Future-Oriented Approach.jpg" height="300px" width="400px" style="border-radius:10px;margin-top: 35px; " class="mb-5" >      </div>  </div>
                
            </div>
            
            
        
        
    </div>
    <div class="row">
      <div class="col-md" style="margin-left:-40px;margin-top:15px;background-color:#f5f5f5;border-radius:10px;margin-bottom: 30px;">
         <div class="row"> 
             <div class="col-7" style="padding:10px;background-color:#f5f5f5;border-radius:10px;">
                 <h2 style="font-family:charlesworth;font-weight:bold;" class="text-center">Want to Do Analysis</h2>
                 <p style="font-family:charlesworth;font-size:17px;text-align:justify;margin-bottom:20px;">"Experience the future of brain health at your fingertips with our groundbreaking MRI scan analysis. Simply upload your scan, and with a single click, unlock invaluable insights into potential brain diseases. Effortlessly bridge the gap between diagnosis and treatment, revolutionizing healthcare with every upload."</p>
                
                <div style="margin-top: 50px;" class="mt-5 text-center">
                 <a href="/crops_production_analysis" style="background-color:#30363d;color:white;padding:13px;margin-right:15px;text-decoration:none;">Crop Production</a>
                 <a href="/fertilizer_link" style="background-color:#30363d;color:white;padding:13px;text-decoration:none;margin-right: 12px;">Fertilizer</a>
                 <a href="/population_link" style="background-color:#30363d;color:white;padding:13px;text-decoration:none;">Agriculturalist Trend</a>
               </div>   
              </div>
             <div class="col-5" style="padding:10px;background-color:#f5f5f5;border-radius:10px;">
               
               <img src="{% static 'images\dashboardanaylsis.png' %}" height="300px" width="400px" style="border-radius:5%; margin-top: 35px;" class="mb-5" >      </div>  </div>
             
         </div>
         
         
     
     
 </div>
    <div class="row" style="margin-top:20px;">
        <div class="col-9" style="background-color:#f5f5f5;padding:18px;margin-left:-40px;text-align: center;border-radius:10px;">
            <h2 style="font-family:charlesworth;font-weight:bold;margin-bottom:15px;">Leaf Disease Detection</h2>
                <img src="{% static 'images\dashboardanaylsis.png' %}" style="height:500px;width:800px;margin-bottom:30px;"><br>
                <a href="/disease_detection" style="background-color:#30363d;color:white;padding:13px 30px;text-decoration:none;">Detect</a>
            </div>
            <div class="col-3" style="border:3px solid gray;margin-left:8px;background-color:#002244; color:white;padding:8px;">
                <h3 style="font-family:charlesworth;text-align:center;margin-bottom:20px;">....Explore More....</h3>
                <button onclick="window.location.href='{% url 'Agri_uni' %}'" style="background-color:white;color:#002244;padding:13px 69px;text-decoration:none;margin-bottom:8px;">Agricultural Universities</button>
                <button onclick="window.location.href='{% url 'Agri_crops' %}'" style="background-color:white;color:#002244;padding:13px 84px;text-decoration:none;margin-bottom:8px;">Agricultural Crops</button>
                <button onclick="window.location.href='{% url 'Agri_latest_technology' %}'" style="background-color:white;color:#002244;padding:13px 84px;text-decoration:none;margin-bottom:8px;">Agricultural Technologies</button>
                <button onclick="window.location.href='{% url 'Agri_farmer_scheme' %}'" style="background-color:white;color:#002244;padding:13px 70px;text-decoration:none;margin-bottom:8px;">Agricultural Schemes</button>
                <button onclick="window.location.href='{% url 'Agri_news' %}'" style="background-color:white;color:#002244;padding:13px 84px;text-decoration:none;margin-bottom:8px;">Agricultural News</button>
                <button onclick="window.location.href='{% url 'help_support' %}'" style="background-color:white;color:#002244;padding:13px 80px;text-decoration:none;margin-bottom:8px;">Help and Support</button>
            </div>
        </div>
    

 

<div id="chatbot-container" style="display: none;">
    <div id="chat-container">
        <!-- Chat messages will be added here -->
    </div>
    <form id="chat-form">
        <input type="text" id="user-input" placeholder="Type a message...">
        <button type="submit">Send</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const chatbotToggle = document.getElementById('chatbot-toggle-button');
    const chatbotContainer = document.getElementById('chatbot-container');
    chatbotToggle.addEventListener('click', function() {
        chatbotContainer.style.display = chatbotContainer.style.display === 'none' ? 'block' : 'none';
    });

    const chatForm = document.getElementById('chat-form');
    chatForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const userInputField = document.getElementById('user-input');
        const userInput = userInputField.value.trim();
        if (!userInput) return;

        addMessage(userInput, 'user-message');
        userInputField.value = '';

        fetch('/chat/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCsrfToken()
            },
            body: JSON.stringify({ 'message': userInput })
        })
        .then(response => response.json())
        .then(data => {
            addMessage(data.response, 'bot-message');
        })
        .catch(error => console.error('Error:', error));
    });


function addMessage(text, className) {
    const container = document.getElementById('chat-container');
    const messageDiv = document.createElement('div');
    messageDiv.textContent = text;
    messageDiv.className = `message ${className}`;
    container.appendChild(messageDiv);

    // Scroll to the bottom every time a new message is added
    container.scrollTop = container.scrollHeight;
}

    function getCsrfToken() {
        const cookies = document.cookie.split(';');
        for (let cookie of cookies) {
            const [name, value] = cookie.trim().split('=');
            if (name === 'csrftoken') return value;
        }
        return '';
    }
});
</script>

{% endblock %}
</body>
</html>